---
title: Selectors
description: Learn how to create, manage, and optimize selectors in Privilege Zones to enhance BloodHound's analysis.
---

<img noZoom src="/assets/enterprise-AND-community-edition-pill-tag.svg" alt="Applies to BloodHound Enterprise and CE"/>

Selectors are rules that associate objects with zones and labels based on object ID, object relationships (expansion), or Cypher queries. BloodHound applies any selector changes during the next analysis operation.

**Zone** selectors provide a logical method of ensuring objects appear in the appropriate zone using either a Cypher query or by searching for an object ID. If an object has been added to multiple zones, the most critical zone in your defined hierarchy takes precedence.

**Label** selectors provide a flexible method of tagging objects in an environment. Objects can have multiple labels and you can use those labels to search and filter using Cypher in the **Explore** page.

### Types

Selectors are rules that automatically tag objects into zones or labels. Think of them as the "how" behind the tagging process.

- **Object selectors** target specific objects and their related objects through "expansion"
- **Cypher selectors** tag objects based on custom query results
- [**Default selectors**](/analyze-data/privilege-zones/default-selectors) are system-managed and tag critical objects automatically

## Selector expansion

Selectors automatically include related objects based on the type of object that you select, expanding through relationships to tag additional objects ([_some exceptions apply_](#tiered-object-control-and-exceptions)).

This "expansion" saves you time by tagging entire groups or organizational units at once. The following sections describe how different object types expand during the tagging process.

### Group-like expansion

Objects that behave like groups in Active Directory include all contained members within the zone/label. These include the following type (edge) relationships:

- Group ([`MemberOf`](/resources/edges/member-of))
- AZRole ([`AZHasRole`](/resources/edges/az-has-role), `AZRoleElligible`)
- AZGroup ([`AZMemberOf`](/resources/edges/az-member-of))

### Structured expansion

Objects that provide structural organization include all contained objects within the zone/label. These include the following type (edge) relationships:

- Domain ([`Contains`](/resources/edges/contains)) 
  <Note>For non-default selectors only.</Note>
- OU ([`Contains`](/resources/edges/contains)
- AZSubscription ([`AZContains`](/resources/edges/az-contains))
- AZManagementGroup ([`AZContains`](/resources/edges/az-contains))
- AZAdministrativeUnit ([`AZContains`](/resources/edges/az-contains))

### Tiered object control and exceptions

During the tagging process for zones, the final step involves tagging all objects that contain (or provide external control of) the selected objects.

For example, in Active Directory this means that all OUs, Containers, and GPOs that apply to any Tier Zero object are _also_ tagged to the Tier Zero zone.

If any OUs or Containers are tagged in the last step of the tagging process only (not because you explicitly selected them), the process won't expand to tag other contained objects.

## Define a selector

<Note>The process and screens for creating and editing label selectors is the same as creating or editing zone selectors.</Note>

If you start defining a selector via the zone creation process, skip to step 2.

1. From the Zone or Labels tab, select "Create Selector"
2. Provide a name
3. Optionally add a description to explain to others on your team, including yourself, the purpose of the Selector
4. Choose a selector type: Cypher or object ID
5. If using Cypher:
   1. Enter the Cypher query into the "Cypher Search" box
   2. To see the sample results, click "Update Sample Results" above the Cypher query box. The first 200 sample results will populate the list to the right
   3. Optionally, click "View in Explore" to pivot to the explore page and view the full Cypher query results
6. If using object ID
   1. Type in the blank to search for an object
   2. Select that object to add to the list
7. Adding the following object types will automatically include (→) more objects according to the definition below
   1. OU/Container → All objects contained in the OU/container
   2. Group → All objects with membership in the Group
   3. AZResourceGroup/AZSubscription → All objects contained in the RG/Sub
   4. AZGroup → All objects with membership in the group
   5. AZRole → All objects with role assignments (or eligibility)
8. Click "Save" to finalize the creation of the selector

Selectors can be enabled or disabled by editing the selector.

## Delete a selector

<img
  src="/images/privzones/objectid_selector.png"
  alt="Example of an Object ID selector"
  title="Privilege Zones Object ID selectors"
  style={{ width:"48%" }}
/>

1. Navigate to the detail view of the zone or label
2. Click on the zone or label containing the desired selector
3. Click on the desired selector
4. Click "Edit" which will open the selector management page
5. Click on "Delete Selector" below the middle column of the page
6. Confirm your changes by typing "Delete this selector" and clicking "confirm"

<img
  src="/images/privzones/selector_delete_confirm.png"
  alt="Delete a selector modal"
  title="Delete a selector modal"
  style={{ width:"49%" }}
/>

7. A toast message will appear in the top right corner of the screen confirming the selector was deleted

<img
  src="/images/privzones/deletion_success_snackbar.png"
  alt="Selector successfully deleted toast message"
  title="Selector successfully deleted toast message"
  style={{ width:"48%" }}
/>

## Disable/enable a selector

1. From the detail view click on a selector
2. Click "Edit" to enter edit mode
3. Under the "Defining Selector" column on the left, click the Enabled/Disabled to toggle the selector

<img
  src="/images/privzones/selector_enable_disable.png"
  alt="Selector enable/disable toggle"
  title="Selector enable/disable toggle"
  style={{ width:"34%" }}
/>