---
title: Selectors
description: Learn how to create, manage, and optimize selectors in Privilege Zones to enhance BloodHound's analysis.
---

<img noZoom src="/assets/enterprise-AND-community-edition-pill-tag.svg" alt="Applies to BloodHound Enterprise and CE"/>

Zone Selectors provide a logical method of ensuring objects appear in the appropriate zone using either a Cypher query or by searching for an object ID. **If an object has been added to multiple Zones, the most critical zone in your defined hierarchy will take precedence.**

Label Selectors are a flexible method of tagging objects in the environments. Objects can have multiple labels, and those labels are searchable and filterable using Cypher in the Explore page. The process and screens for creating and editing label selectors is the same as creating or editing zone selectors.

Any changes made to a selector will take effect on the next analysis.

<Note>See [Default Selectors](/analyze-data/privilege-zones/default-selectors) for a list of predefined selectors included with BloodHound.</Note>

### Selectors

Selectors are rules that automatically tag objects into zones or labels. Think of them as the "how" behind the tagging process.

- **Object selectors** target specific objects and their related objects
- **Cypher selectors** tag objects based on custom query results
- **Default selectors** are system-managed and tag critical objects automatically (you can disable some defaults, but you cannot modify their criteria)

## Selector Expansion

Flag from Dillon: Need to be very clear on criteria here, particularly with limitations or exceptions. This could run into performance/limitation concerns in engineering. Ex) Can/should we provide a “expansion depth warning”?

Selectors provide some ease-of-use behavior behind the scenes based on the type of objects selected. Selected objects of specific types should expand through relationships to tag additional objects (certain exceptions apply, see below).

“Group-like” Expansion:

Objects which behave like Groups in AD should include all contained members within the Tier/Label. These include the following Type (Edge) relationships:

- Group (MemberOf)
- AZRole (AZHasRole, AZRoleElligible)
- AZGroup (AZMemberOf)

“Structured” Expansion:

Objects which provide structural organization should include all contained objects within the Tier/Label. These include the following Type (Edge) relationships.

- Domain (Contains)
  - Only for non-default selectors
- OU (Contains)
- AZSubscription (AZContains)
- AZManagementGroup (AZContains)
- AZAdministrativeUnit (AZContains)

Tiered Object Control and Exceptions:

During the tagging process for Tiers, the final step of tagging involves tagging all objects which contain and/or provide external control on the selected objects. In Active Directory, for example, this means that all OUs, Containers, and GPOs which apply to any Tier Zero object are also tagged to Tier Zero. During this process, any OUs or Containers tagged only by this final process should not also tag other contained objects.

## How selectors expand

Selectors automatically include related objects based on the type of object you select. This expansion saves you time by tagging entire groups or organizational units at once.

**Group-like expansion**

When you select group-like objects, BloodHound automatically includes all members:

- **Groups** → includes all members (via MemberOf)
- **Azure Roles** → includes all users with the role (via AZHasRole, AZRoleEligible)
- **Azure Groups** → includes all members (via AZMemberOf)

**Structured expansion**

When you select organizational containers, BloodHound includes all contained objects:

- **Organizational Units (OUs)** → includes all objects in the OU (via Contains)
- **Azure Subscriptions** → includes all resources (via AZContains)
- **Azure Management Groups** → includes all child resources (via AZContains)
- **Azure Administrative Units** → includes all contained objects (via AZContains)
- **Domains** → includes contained objects (only for custom selectors, not defaults)

**Tier-specific tagging**

When tagging objects into tiers, BloodHound also tags the containers and policies that control those objects. For example, in Active Directory, any OUs, Containers, or GPOs that apply to Tier Zero objects are also tagged as Tier Zero.

**Important:** If a container is tagged only because it controls tier objects (not because you explicitly selected it), it won't expand to include its other contents. This prevents unintended scope creep.

Defining a selector using Cypher

<img
  src="/images/privzones/cypher_selector.png"
  alt="Example of Cypher selector"
  title="Example of Cypher selector"
  style={{ width:"53%" }}
/>

Defining a selector using Object ID

<img
  src="/images/privzones/objectid_selector.png"
  alt="Example of an Object ID selector"
  title="Privilege Zones Object ID selectors"
  style={{ width:"53%" }}
/>

## Defining a Selector

If you start defining a selector via the zone creation process, skip to step 2.

1. From the Zone or Labels tab, select "Create Selector"
2. Provide a name
3. Optionally add a description to explain to others on your team, including yourself, the purpose of the Selector
4. Choose a selector type: Cypher or object ID
5. If using Cypher:
   1. Enter the Cypher query into the "Cypher Search" box
   2. To see the sample results, click "Update Sample Results" above the Cypher query box. The first 200 sample results will populate the list to the right
   3. Optionally, click "View in Explore" to pivot to the explore page and view the full Cypher query results
6. If using object ID
   1. Type in the blank to search for an object
   2. Select that object to add to the list
7. Adding the following object types will automatically include (→) more objects according to the definition below
   1. OU/Container → All objects contained in the OU/container
   2. Group → All objects with membership in the Group
   3. AZResourceGroup/AZSubscription → All objects contained in the RG/Sub
   4. AZGroup → All objects with membership in the group
   5. AZRole → All objects with role assignments (or eligibility)
8. Click "Save" to finalize the creation of the selector

Selectors can be enabled or disabled by editing the selector.

## Deleting a Selector

<img
  src="/images/privzones/objectid_selector.png"
  alt="Example of an Object ID selector"
  title="Privilege Zones Object ID selectors"
  style={{ width:"48%" }}
/>

1. Navigate to the detail view of the zone or label
2. Click on the zone or label containing the desired selector
3. Click on the desired selector
4. Click "Edit" which will open the selector management page
5. Click on "Delete Selector" below the middle column of the page
6. Confirm your changes by typing "Delete this selector" and clicking "confirm"

<img
  src="/images/privzones/selector_delete_confirm.png"
  alt="Delete a selector modal"
  title="Delete a selector modal"
  style={{ width:"49%" }}
/>

7. A toast message will appear in the top right corner of the screen confirming the selector was deleted

<img
  src="/images/privzones/deletion_success_snackbar.png"
  alt="Selector successfully deleted toast message"
  title="Selector successfully deleted toast message"
  style={{ width:"48%" }}
/>

## Disable/Enable a Selector

1. From the detail view click on a selector
2. Click "Edit" to enter edit mode
3. Under the "Defining Selector" column on the left, click the Enabled/Disabled to toggle the selector

<img
  src="/images/privzones/selector_enable_disable.png"
  alt="Selector enable/disable toggle"
  title="Selector enable/disable toggle"
  style={{ width:"34%" }}
/>